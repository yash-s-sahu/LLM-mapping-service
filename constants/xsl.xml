<?xml version="1.0" encoding="UTF-8"?>
<?oracle-xsl-mapper <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="XSD">
      <schema location="oramds:/apps/oracle/apps/scm/cmk/xsd/message/ProcessPurchaseOrder-OAGIS10.1-Inbound-CollaborationMessage.xsd"/>
      <rootElement name="processInboundCollaborationMessage" namespace="http://xmlns.oracle.com/apps/scm/cmk"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="XSD">
      <schema location="oramds:/apps/oracle/apps/scm/cmk/xsd/document/PurchaseOrder-DOO-CSVInbound.xsd"/>
      <rootElement name="processInboundCollaborationDocument" namespace="http://xmlns.oracle.com/apps/scm/cmk"/>
    </target>
  </mapTargets>
  <substitutions>
      <sourceSubst substPath="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage" substType="cmk:ProcessPurchaseOrderOAGIS10.1InboundType"/>
  </substitutions>
  <!-- GENERATED BY ORACLE XSL MAPPER 11.1.1.7.0(build 130301.0647.0008) AT [THU JUN 11 19:59:44 EDT 2015]. -->
?>
<xsl:stylesheet version="1.0"
	xmlns:ns1="http://xmlns.oracle.com/apps/scm/receiving/supplierTransactions/createASN/RcvCreateASNB2BConnectorComposite/schema"
	xmlns:aia="http://www.oracle.com/XSL/Transform/java/oracle.apps.aia.core.xpath.AIAFunctions"
	xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
	xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
	xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:ns3="http://xmlns.oracle.com/soa/b2b/OAG/7.2.1/PROCESS_INVOICE_002/OAG_DEF/"
	xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
	xmlns:ns12="http://xmlns.oracle.com/apps/scm/receiving/receiptsInterface/receiptConfirmation/receiptConfirmationService/"
	xmlns:oa="http://www.openapplications.org/oagis/10"
	xmlns:ns6="http://xmlns.oracle.com/apps/scm/receiving/receiptsInterface/transactions/processorServiceV2/"
	xmlns:ora="http://schemas.oracle.com/xpath/extension"
	xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
	xmlns:ns9="http://xmlns.oracle.com/adf/svc/errors/"
	xmlns:ns11="http://xmlns.oracle.com/apps/scm/receiving/receiptsInterface/transactions/processorServiceV2/types/"
	xmlns:ns4="http://xmlns.oracle.com/apps/financials/payables/invoices/quickInvoices/invoiceInterfaceService/"
	xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
	xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
	xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
	xmlns:ns7="http://xmlns.oracle.com/adf/svc/types/"
	xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
	xmlns:ns10="commonj.sdo/java"
	xmlns:med="http://schemas.oracle.com/mediator/xpath"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
	xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
	xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
	xmlns:cmk="http://xmlns.oracle.com/apps/scm/cmk" xmlns="http://xmlns.oracle.com/apps/scm/cmk"
	xmlns:ns5="commonj.sdo"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	xmlns:ns8="http://xmlns.oracle.com/apps/financials/payables/invoices/quickInvoices/invoiceInterfaceService/types/"
	xmlns:bpmn="http://schemas.oracle.com/bpm/xpath" xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
	exclude-result-prefixes="xsl ns1 ns3 oa xsd ns12 ns6 ns9 ns11 ns4 ns7 ns10 ns5 ns8 aia bpws xp20 bpel bpm ora socket mhdr oraext dvm hwf med ids xdk xref bpmn ldap">


	<xsl:variable name="dvm" select="true()"/>
	<xsl:variable name="prod" select="$dvm"/>
	<xsl:variable name="xpath" select="false()"/>


	<xsl:variable name="verb" select="'PROCESS'"/>
	<xsl:variable name="bodid" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/oa:ProcessPurchaseOrder/oa:ApplicationArea/oa:BODID"/>

	<xsl:variable name="DvmGroup" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration/cmk:DvmGroup"/>
	<xsl:variable name="senderMessageId" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration/cmk:SenderMessageId"/>
	<xsl:variable name="partnerKey1" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration/cmk:PartnerKey1"/>
	<xsl:variable name="partnerKey2" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration/cmk:PartnerKey2"/>
	<xsl:variable name="configurationData1" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration/cmk:ConfigurationData1"/>
	<xsl:variable name="eoss" select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration/cmk:ElectronicOrderSourceSystem"/>

	<xsl:template match="/">
		<cmk:processInboundCollaborationDocument>
			<cmk:InboundCollaborationDocument>
				<xsl:attribute name="xsi:type"><xsl:text disable-output-escaping="no">cmk:ProcessPurchaseOrderInboundType</xsl:text></xsl:attribute>
<!--				<cmk:MessageID>
					<xsl:value-of select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:MessageID"/>
				</cmk:MessageID>
				<xsl:copy-of select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/cmk:ProcessingConfiguration">
					<?oracle-xsl-mapper-position cmk:ProcessingConfiguration?>
				</xsl:copy-of> -->
				<xsl:apply-templates select="/cmk:processInboundCollaborationMessage/cmk:InboundCollaborationMessage/oa:ProcessPurchaseOrder"/>
			</cmk:InboundCollaborationDocument>
		</cmk:processInboundCollaborationDocument>
	</xsl:template>

	<xsl:template match="oa:ProcessPurchaseOrder">
		<xsl:element name="DOO_ORDERS" namespace="http://xmlns.oracle.com/apps/scm/cmk">
			<xsl:apply-templates select="oa:DataArea/oa:PurchaseOrder"/>
		</xsl:element>
	</xsl:template>


	<xsl:template match="oa:PurchaseOrder">
		<xsl:element name="DOO_ORDER" namespace="http://xmlns.oracle.com/apps/scm/cmk">
			<xsl:variable name="poNumber" select="oa:PurchaseOrderHeader/oa:ID"/>
			<xsl:variable name="srcTransOrderID">
				<xsl:value-of select="concat('01-',$partnerKey1,'-', $poNumber)"/>
			</xsl:variable>
			<xsl:variable name="srcTransOrderRevision">
				<xsl:value-of select="oa:PurchaseOrderHeader/oa:RevisionID"/>
			</xsl:variable>

			<xsl:variable name="createCustomerInformationFlag">
				<xsl:for-each select="oa:PurchaseOrderHeader/oa:Extension[@typeCode='OracleExtension']">
					<xsl:for-each select="oa:ValueText[@typeCode='CreateCustomerInformationFlag']">
						<xsl:value-of select="."/>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:variable>

			<xsl:apply-templates select="oa:PurchaseOrderHeader">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransOrderNumber" select="$poNumber"/>
				<xsl:with-param name="srcTransOrderRevision" select="$srcTransOrderRevision"/>
				<xsl:with-param name="transCode" select="@typeCode"/>
				<xsl:with-param name="createCustomer" select="$createCustomerInformationFlag"/>
			</xsl:apply-templates>

			<xsl:apply-templates select="oa:PurchaseOrderLine">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransOrderCustomer" select="$poNumber"/>
				<xsl:with-param name="createCustomer" select="$createCustomerInformationFlag"/>
			</xsl:apply-templates>
		</xsl:element>
	</xsl:template>


	<xsl:template match="oa:PurchaseOrderHeader">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransOrderNumber"/>
		<xsl:param name="srcTransOrderRevision"/>
		<xsl:param name="transCode"/>
		<xsl:param name="createCustomer"/>

		<xsl:element name="DooOrderHeadersAllInt">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionNumber">
				<xsl:value-of select="$srcTransOrderNumber"/>
			</xsl:element>
			<xsl:element name="SourceTransactionRevisionNumber">
				<xsl:value-of select="$srcTransOrderRevision"/>
			</xsl:element>
			<xsl:element name="BuyingPartyId">
				<xsl:value-of select="$partnerKey1"/>
			</xsl:element>
			<xsl:element name="BuyingPartyName">
				<xsl:value-of select="oa:BuyerParty/oa:Name"/>
			</xsl:element>
			<xsl:element name="BuyingPartyFirstName">
								<xsl:value-of select="oa:BuyerParty/oa:Contact/oa:PersonName/oa:GivenName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyLastName">
								<xsl:value-of select="oa:BuyerParty/oa:Contact/oa:PersonName/oa:FamilyName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyMiddleName">
								<xsl:value-of select="oa:BuyerParty/oa:Contact/oa:PersonName/oa:MiddleName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyNameSuffix">
								<xsl:value-of select="oa:BuyerParty/oa:Contact/oa:PersonName/oa:TitleAffixCode"/>
			</xsl:element>
			<xsl:element name="BuyingPartyTitle">
								<xsl:value-of select="oa:BuyerParty/oa:Contact/oa:JobTitle"/>
			</xsl:element>
			<xsl:element name="BuyingPartyNumber">
				<xsl:value-of select="$partnerKey2"/>
			</xsl:element>
			<xsl:element name="BuyingPartyOrigSysReference"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="BuyingPartyContactId"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="BuyingPartyContactName">
				<xsl:value-of select="oa:BuyerParty/oa:BuyerContact/oa:PersonName/oa:FormattedName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyContactFirstName">
				<xsl:value-of select="oa:BuyerParty/oa:BuyerContact/oa:PersonName/oa:GivenName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyContactLastName">
				<xsl:value-of select="oa:BuyerParty/oa:BuyerContact/oa:PersonName/oa:FamilyName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyContactMiddleName">
				<xsl:value-of select="oa:BuyerParty/oa:BuyerContact/oa:PersonName/oa:MiddleName"/>
			</xsl:element>
			<xsl:element name="BuyingPartyContactNameSuffix">
				<xsl:value-of select="oa:BuyerParty/oa:BuyerContact/oa:PersonName/oa:TitleAffixCode"/>
			</xsl:element>
			<xsl:element name="BuyingPartyContactTitle">
				<xsl:value-of select="oa:BuyerParty/oa:BuyerContact/oa:JobTitle"/>
			</xsl:element>
			<xsl:element name="BuyingPartyType"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="BuyingPartyContactNumber"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="BuyingPartyContactOrigSysReference"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="PreferredSoldToContactPointId"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="PreferredSoldToContactPointOrigSysReference"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="CustomerPONumber">
				<xsl:value-of select="oa:ID"/>
			</xsl:element>
			<xsl:element name="TransactionalCurrencyCode">
				<xsl:choose>
					<xsl:when test="$dvm">
						<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",oa:TotalAmount/@currencyCode,"Fusion Value",oa:TotalAmount/@currencyCode,"DVM Name","CURRENCY_CODE","Trading Partner",$DvmGroup)'/>
					</xsl:when>
					<xsl:otherwise>
						<xsl:value-of select="oa:TotalAmount/@currencyCode"/>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:element>
			<xsl:element name="TransactionalCurrencyName"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="CurrencyConversionType"/>
			<xsl:element name="CurrencyConversionRate"/>
			<xsl:element name="CurrencyConversionDate"/>
			<xsl:element name="TransactionOn">
				<xsl:value-of select="oa:OrderDateTime"/>
			</xsl:element>
			<xsl:element name="RequestingBusinessUnitId">
				<!-- AN Object Key -->
				<xsl:value-of select="$configurationData1"/>
			</xsl:element>
			<xsl:element name="RequestingBusinessUnit"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="TransactionTypeCode">
				<xsl:value-of select="$transCode"/>
			</xsl:element>
			<xsl:element name="TransactionDocumentTypeCode">
				<!-- Not Mapped per DOO Review -->
			</xsl:element>
			<xsl:element name="RequestCancelDate">

				<xsl:if test="$verb = 'CANCEL'">
					<xsl:value-of select="oa:LastModificationDateTime"/>
				</xsl:if>
<!--				<xsl:for-each select="oa:Status">
					<xsl:if test="@typeCode = 'CancelOrder'">
						<xsl:value-of select="oa:EffectiveTimePeriod/oa:StartDateTime"/>
					</xsl:if>
				</xsl:for-each>  -->
			</xsl:element>
			<xsl:element name="Comments">
				<xsl:value-of select="oa:Description"/>
<!--				<xsl:for-each select="oa:Description[@typeCode = 'Comments']">
					<xsl:value-of select="."/>
				</xsl:for-each>  -->
			</xsl:element>
			<xsl:element name="BatchName">
				<xsl:value-of select="$bodid"/>
			</xsl:element>
			<xsl:element name="RequestingLegalUnitId"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="RequestingLegalUnit"/>
			<!-- Not Mapped per DOO Review -->
			<xsl:element name="OrigSysDocumentReference">
				<xsl:value-of select="$bodid"/>
			</xsl:element>
			<xsl:element name="PartialShipAllowedFlag">
				<xsl:call-template name="convertBooleanToYesNo">
					<xsl:with-param name="value" select="oa:PartialShipmentAllowedIndicator"/>
				</xsl:call-template>
			</xsl:element>
			<xsl:choose>
				<xsl:when test="$verb = 'PROCESS'">
					<xsl:element name="CancelReasonCode"/>
					<xsl:element name="CancelReason"/>
				</xsl:when>
				<xsl:when test="$verb = 'CHANGE'">
					<xsl:element name="CancelReasonCode"/>
					<xsl:element name="CancelReason"/>
				</xsl:when>
				<xsl:when test="$verb = 'CANCEL'">
				<xsl:element name="CancelReasonCode">
						<xsl:for-each select="oa:Status">

								<xsl:value-of select="oa:ReasonCode"/>

						</xsl:for-each>
					</xsl:element>
					<xsl:element name="CancelReason">
						<xsl:for-each select="oa:Status">

								<xsl:value-of select="oa:Reason"/>

						</xsl:for-each>
					</xsl:element>
				</xsl:when>

<!--				<xsl:otherwise>
					<xsl:element name="CancelReasonCode">
						<xsl:for-each select="oa:Status">
							<xsl:if test="@typeCode = 'CancelOrder'">
								<xsl:value-of select="oa:ReasonCode"/>
							</xsl:if>
						</xsl:for-each>
					</xsl:element>
					<xsl:element name="CancelReason">
						<xsl:for-each select="oa:Status">
							<xsl:if test="@typeCode = 'CancelOrder'">
								<xsl:value-of select="oa:Reason"/>
							</xsl:if>
						</xsl:for-each>
					</xsl:element>
				</xsl:otherwise>  -->
			</xsl:choose>
			<xsl:element name="PricedOn"/>
			<xsl:element name="FreezePricing">
				<xsl:text>N</xsl:text>
			</xsl:element>
			<xsl:element name="FreezeShippingCharge">
				<xsl:text>N</xsl:text>
			</xsl:element>
			<xsl:element name="FreezeTax">
				<xsl:text>N</xsl:text>
			</xsl:element>
			<xsl:element name="OperationMode">
				<xsl:choose>
					<xsl:when test="$verb = 'CANCEL'">
						<xsl:text>CANCEL</xsl:text>
					</xsl:when>
				</xsl:choose>
			</xsl:element>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'CreateCustomerInformationFlag'"/>
			</xsl:call-template>


<!--			<xsl:element name="CreateCustomerInformationFlag"/> -->
			<xsl:element name="RevisionSourceTransactionSystem">
				<xsl:choose>
					<xsl:when test="$verb = 'PROCESS'"/>
					<xsl:otherwise>
						<xsl:value-of select="$eoss"/>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:element>

			<xsl:element name="BuyingPartyPersonEmail"/>
			<xsl:element name="BuyingPartyPersonOrganizationEmail"/>
			<xsl:element name="BuyingPartyContactEmail"/>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SubmitFlag'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PreCreditCheckedFlag'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SalesChannelCode'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SalesChannel'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SalesPersonId'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SalesPerson'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'AgreementHeaderId'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'AgreementNumber'"/>
			</xsl:call-template>


			<xsl:call-template name="DoAddresses">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="''"/>
				<xsl:with-param name="srcTransSchedID" select="''"/>
				<xsl:with-param name="createCustomer" select="$createCustomer"/>
			</xsl:call-template>

			<xsl:apply-templates select="oa:Extension[@typeCode = 'OraclePaymentExtension']">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="''"/>
				<xsl:with-param name="srcTransSchedID" select="''"/>
			</xsl:apply-templates>
			<xsl:apply-templates select="oa:DocumentReference">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="''"/>
				<xsl:with-param name="srcTransSchedID" select="''"/>
			</xsl:apply-templates>
			<xsl:apply-templates select="oa:Extension[@typeCode = 'OracleEFFExtension']">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="''"/>
				<xsl:with-param name="srcTransSchedID" select="''"/>
				<xsl:with-param name="extName" select="'DooOrderHdrsAllEffBInt'"/>
			</xsl:apply-templates>
		</xsl:element>
	</xsl:template>


	<!-- Party / Address -->
	<xsl:template name="DoAddresses">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:param name="createCustomer"/>

		<xsl:choose>
			<xsl:when test="$srcTransLineID">
				<xsl:for-each select="oa:Party[@role = 'BillTo']">
					<xsl:call-template name="DoAddress">
						<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
						<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
						<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
						<xsl:with-param name="use" select="'BILL_TO'"/>
						<xsl:with-param name="createCustomer" select="$createCustomer"/>
					</xsl:call-template>
				</xsl:for-each>
				<!--
				<xsl:for-each select="oa:Party[@typeCode = 'Supplier']">
					<xsl:call-template name="DoAddress">
						<xsl:with-param name="srcTransOrder" select="$srcTransOrder"/>
						<xsl:with-param name="srcTransLine" select="false()"/>
						<xsl:with-param name="srcTransSubLine" select="false()"/>
						<xsl:with-param name="use" select="'SUPPLIER'"/>
					</xsl:call-template>
				</xsl:for-each>
	-->
			</xsl:when>
			<xsl:otherwise>
				<xsl:for-each select="oa:BillToParty">
					<xsl:call-template name="DoAddress">
						<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
						<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
						<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
						<xsl:with-param name="use" select="'BILL_TO'"/>
						<xsl:with-param name="createCustomer" select="$createCustomer"/>
					</xsl:call-template>
				</xsl:for-each>
				<!--
				<xsl:for-each select="oa:SupplierParty">
					<xsl:call-template name="DoAddress">
						<xsl:with-param name="srcTransOrder" select="$srcTransOrder"/>
						<xsl:with-param name="srcTransLine" select="false()"/>
						<xsl:with-param name="srcTransSubLine" select="false()"/>
						<xsl:with-param name="use" select="'SUPPLIER'"/>
					</xsl:call-template>
				</xsl:for-each>
-->
			</xsl:otherwise>
		</xsl:choose>
		<xsl:for-each select="oa:ShipToParty">
			<xsl:call-template name="DoAddress">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
				<xsl:with-param name="use" select="'SHIP_TO'"/>
				<xsl:with-param name="createCustomer" select="$createCustomer"/>
			</xsl:call-template>
		</xsl:for-each>
	</xsl:template>




	<xsl:template name="DoAddress">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:param name="use"/>
		<xsl:param name="createCustomer"/>

		<xsl:element name="DooOrderAddressesInt">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<!-- Set Schedule Line Number to Line Line Number -->
				<xsl:value-of select="$srcTransSchedID"/>

			</xsl:element>
			<xsl:element name="AddressUseType">
				<xsl:value-of select="$use"/>
			</xsl:element>

			<xsl:element name="PartyId"/>


			<!-- Don't Map -->
			<xsl:element name="PartyNumber">
				<xsl:if test="$use = 'SHIP_TO'">
					<xsl:for-each select="oa:ID">
<!--						<xsl:if test="@typeCode = 'Number'"> -->
							<xsl:value-of select="."/>
<!--						</xsl:if>  -->
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="PartyName">
				<xsl:if test="$use = 'SHIP_TO'">
					<xsl:value-of select="oa:Name"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="CustomerId"/>
			<!-- Don't Map -->
			<xsl:element name="CustomerNumber">
				<xsl:if test="$use = 'BILL_TO'">
					<xsl:for-each select="oa:AccountID">
						<xsl:value-of select="."/>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="CustomerName">
				<xsl:if test="$use = 'BILL_TO'">
					<xsl:value-of select="oa:Name"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="RequestedSupplierCode"/>
			<!-- Don't Map -->
			<xsl:element name="RequestedSupplierNumber"/>
			<!-- Don't Map -->
			<xsl:element name="RequestedSupplierName"/>
			<!-- Don't Map -->
			<xsl:element name="PartySiteId">
				<xsl:if test="$use = 'SHIP_TO'">
					<xsl:for-each select="oa:Location/oa:IDSet/oa:ID">
						<xsl:if test="@typeCode = 'PartySiteId'">
							<xsl:choose>
								<xsl:when test="$dvm">
									<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","EDI_LOCATION","Trading Partner",$DvmGroup)'/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:value-of select="."/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:if>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<!--  Don't Map  -->
			<xsl:element name="AccountSiteUseId">
				<xsl:if test="$use = 'BILL_TO'">
					<xsl:for-each select="oa:Location/oa:IDSet/oa:ID">
						<xsl:if test="@typeCode = 'AccountSiteUseId'">
							<xsl:choose>
								<xsl:when test="$dvm">
									<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","EDI_LOCATION","Trading Partner",$DvmGroup)'/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:value-of select="."/>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:if>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="RequestedSupplierSiteId"/>
			<!-- Don't Map -->
			<xsl:element name="AddressOrigSysReference"/>
			<xsl:element name="AddressLine1">
				<xsl:for-each select="oa:Location/oa:Address/oa:AddressLine">
					<xsl:if test="@sequenceNumber = 1">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="AddressLine2">
				<xsl:for-each select="oa:Location/oa:Address/oa:AddressLine">
					<xsl:if test="@sequenceNumber = 2">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="AddressLine3">
				<xsl:for-each select="oa:Location/oa:Address/oa:AddressLine">
					<xsl:if test="@sequenceNumber = 3">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="AddressLine4">
				<xsl:for-each select="oa:Location/oa:Address/oa:AddressLine">
					<xsl:if test="@sequenceNumber = 4">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="City">
				<xsl:value-of select="oa:Location/oa:Address/oa:CityName"/>
			</xsl:element>
			<xsl:element name="PostalCode">
				<xsl:value-of select="oa:Location/oa:Address/oa:PostalCode"/>
			</xsl:element>
			<xsl:element name="State">
				<xsl:for-each select="oa:Location/oa:Address/oa:CountrySubDivisionCode">
					<xsl:if test="@typeCode = 'State'">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","STATE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="."/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="Province">
				<xsl:for-each select="oa:Location/oa:Address/oa:CountrySubDivisionCode">
					<xsl:if test="@typeCode = 'Province'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="County">
				<xsl:for-each select="oa:Location/oa:Address/oa:CountrySubDivisionCode">
					<xsl:if test="@typeCode = 'County'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="Country">
				<xsl:choose>
					<xsl:when test="$dvm">
						<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",oa:Location/oa:Address/oa:CountryCode,"Fusion Value",oa:Location/oa:Address/oa:CountryCode,"DVM Name","COUNTRY_CODE","Trading Partner",$DvmGroup)'/>
					</xsl:when>
					<xsl:otherwise>
						<xsl:value-of select="oa:Location/oa:Address/oa:CountryCode"/>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:element>
			<xsl:element name="ShipToRequestRegion"/>
			<xsl:element name="PartyContactId"/>
			<!-- Don't map  -->

			<xsl:element name="PartyContactNumber">
				<xsl:if test="$use = 'SHIP_TO'">
					<xsl:for-each select="oa:Contact">
						<xsl:if test="not(@typeCode)">
							<xsl:for-each select="oa:ID">
									<xsl:value-of select="."/>
							</xsl:for-each>
						</xsl:if>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="PartyContactName">
				<xsl:if test="$use = 'SHIP_TO'">
					<xsl:for-each select="oa:Contact">
						<xsl:if test="not(@typeCode)">
							<xsl:value-of select="oa:PersonName/oa:FormattedName"/>
						</xsl:if>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="AccountContactId">
				<!-- Don't map  -->
			</xsl:element>
			<xsl:element name="AccountContactNumber">
				<xsl:if test="$use = 'BILL_TO'">
					<xsl:for-each select="oa:Contact">
						<xsl:if test="not(@typeCode)">
							<xsl:for-each select="oa:ID">

									<xsl:value-of select="."/>

							</xsl:for-each>
						</xsl:if>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="AccountContactName">
				<xsl:if test="$use = 'BILL_TO'">
					<xsl:for-each select="oa:Contact">
						<xsl:if test="not(@typeCode)">
							<xsl:value-of select="oa:PersonName/oa:FormattedName"/>
						</xsl:if>
					</xsl:for-each>
				</xsl:if>
			</xsl:element>
			<xsl:element name="ContactOrigSysReference"/>
			<xsl:element name="LocationId">
				<!-- Don't map  -->
			</xsl:element>
			<xsl:element name="PreferredContactPointId">
				<!-- Don't map  -->
			</xsl:element>
			<xsl:element name="PreferredContactOrigSysReference"/>
			<xsl:element name="FirstName">
				<xsl:for-each select="oa:Contact[@typeCode = 'IndividualContact']">
					<xsl:value-of select="oa:PersonName/oa:GivenName"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="LastName">
				<xsl:for-each select="oa:Contact[@typeCode = 'IndividualContact']">
					<xsl:value-of select="oa:PersonName/oa:FamilyName"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="MiddleName">
				<xsl:for-each select="oa:Contact[@typeCode = 'IndividualContact']">
					<xsl:value-of select="oa:PersonName/oa:MiddleName"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="NameSuffix">
				<xsl:for-each select="oa:Contact[@typeCode = 'IndividualContact']">
					<xsl:value-of select="oa:PersonName/oa:TitleAffixCode"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="Title">
				<xsl:for-each select="oa:Contact[@typeCode = 'IndividualContact']">
					<xsl:value-of select="oa:JobTitle"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ContactFirstName">
				<xsl:for-each select="oa:Contact[@typeCode = 'OrganizationContact']">
					<xsl:value-of select="oa:PersonName/oa:GivenName"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ContactLastName">
				<xsl:for-each select="oa:Contact[@typeCode = 'OrganizationContact']">
					<xsl:value-of select="oa:PersonName/oa:FamilyName"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ContactMiddleName">
				<xsl:for-each select="oa:Contact[@typeCode = 'OrganizationContact']">
					<xsl:value-of select="oa:PersonName/oa:MiddleName"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ContactNameSuffix">
				<xsl:for-each select="oa:Contact[@typeCode = 'OrganizationContact']">
					<xsl:value-of select="oa:PersonName/oa:QualificationAffixCode"/>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ContactTitle">
				<xsl:for-each select="oa:Contact[@typeCode = 'OrganizationContact']">
					<xsl:value-of select="oa:JobTitle"/>
				</xsl:for-each>
			</xsl:element>



			<xsl:choose>
				<xsl:when test="$createCustomer = 'Y' or $createCustomer = 'true' or $createCustomer = 'True'">

		<xsl:choose>
			<xsl:when test="@typeCode = 'ORGANIZATION' or @typeCode = '' or not(@typeCode)">
				<xsl:element name="PartyType">
					<xsl:text>ORGANIZATION</xsl:text>
				</xsl:element>
			</xsl:when>
			<xsl:when test="@typeCode = 'PERSON'">
				<xsl:element name="PartyType">
					<xsl:text>PERSON</xsl:text>
				</xsl:element>
			</xsl:when>
			<xsl:otherwise>
				<xsl:element name="PartyType"/>
			</xsl:otherwise>
		</xsl:choose>

				</xsl:when>
				<xsl:otherwise>
					<xsl:element name="PartyType"/>
				</xsl:otherwise>
			</xsl:choose>


			<xsl:element name="DestinationShippingOrganizationId">
				<!-- Don't map  -->
			</xsl:element>
			<xsl:element name="DestinationShippingOrganizationCode">
				<!-- Don't map  -->
			</xsl:element>
			<xsl:element name="DestinationShippingOrganizationName">
				<!-- Don't map  -->
			</xsl:element>
		</xsl:element>
	</xsl:template>




	<!-- Payment -->
	<xsl:template match="oa:Extension[@typeCode = 'OraclePaymentExtension']">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>

		<xsl:element name="DooOrderPaymentsInt">

			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>

			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>

			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>
			</xsl:element>

			<!-- mlr Look to change PaymentMethodCode to PaymentMethodId to match the DOO spreadsheet. -->
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'PaymentMethodCode'"/>
			</xsl:call-template>

			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'PaymentMethod'"/>
			</xsl:call-template>

			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'PaymentTransactionId'"/>
			</xsl:call-template>

			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'PaymentSetId'"/>
			</xsl:call-template>

<!-- mlr Autogenerate this assign a level.   Add segment number.
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'SourceTransactionPaymentId'"/>
			</xsl:call-template>			-->

			<xsl:element name="SourceTransactionPaymentId">
				<xsl:text>06-</xsl:text>
				<xsl:call-template name="getNodeCount"/>
<!--
				<xsl:choose>
					<xsl:when test="$srcTransLineID = ''">
						<xsl:value-of select="concat($srcTransOrderID,'-06-',position())"/>
					</xsl:when>
					<xsl:when test="$srcTransSchedID = ''">
						<xsl:value-of select="concat($srcTransLineID,'-06-',position())"/>
					</xsl:when>
					<xsl:otherwise>
						<xsl:value-of select="concat($srcTransSchedID,'-06-',position())"/>
					</xsl:otherwise>
				</xsl:choose> -->

			</xsl:element>

		</xsl:element>

	</xsl:template>



	<!-- DocumentReference -->
	<xsl:template match="oa:DocumentReference">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>

		<xsl:element name="DooOrderDocReferencesInt">

			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>

			</xsl:element>

			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>

			<xsl:element name="DocumentReferenceType">
				<xsl:value-of select="@typeCode"/>
			</xsl:element>
			<xsl:element name="DocumentId">

				<xsl:for-each select="oa:DocumentIDSet">
<!--					<xsl:if test="@typeCode = 'ID'"> -->
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'DocumentId'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
<!--					</xsl:if> -->
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentAdditionalId">
				<xsl:for-each select="oa:DocumentIDSet">

						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'DocumentAdditionalId'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>

				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentNumber">
				<xsl:for-each select="oa:DocumentIDSet">

						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'DocumentNumber'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>

				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentAdditionalNumber">
				<xsl:for-each select="oa:DocumentIDSet">

						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'DocumentAdditionalNumber'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>

				</xsl:for-each>
			</xsl:element>

			<!-- mlr move to DocIDSet for all -->
			<xsl:element name="DocumentLineId">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'ID'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'ID'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>


			<xsl:element name="DocumentAdditionalLineId">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'Additional'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'ID'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentLineNumber">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'ID'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'Number'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentAdditionalLineNumber">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'Additional'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'Number'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>

			<xsl:element name="DocumentSubLineId">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'SubLine'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'ID'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentAdditionalSubLineId">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'AdditionalSubLine'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'ID'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentSubLineNumber">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'SubLine'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'Number'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DocumentAdditionalSubLineNumber">
				<xsl:for-each select="oa:LineIDSet">
					<xsl:if test="@typeCode = 'AdditionalSubLine'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'Number'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
		</xsl:element>
	</xsl:template>

	<!-- Header EFF -->
	<xsl:template match="oa:Extension[@typeCode = 'OracleEFFExtension']">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:param name="extName"/>

		<xsl:element name="{$extName}">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>

			<xsl:choose>
				<xsl:when test="$srcTransLineID">
					<xsl:element name="SourceTransactionLineId">
						<xsl:if test="$srcTransLineID">
							<xsl:value-of select="$srcTransLineID"/>
						</xsl:if>
					</xsl:element>
					<xsl:element name="SourceTransactionScheduleId">
						<xsl:value-of select="$srcTransSchedID"/>

					</xsl:element>
				</xsl:when>
			</xsl:choose>

			<xsl:element name="ContextCode">
				<xsl:for-each select="oa:Code">
					<xsl:if test="@typeCode = 'ContextCode'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR1'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR2'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR3'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR4'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR5'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR6'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR7'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR8'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR9'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR10'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR11'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR12'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR13'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR14'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR15'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR16'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR17'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR18'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR19'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_CHAR20'"/>
			</xsl:call-template>

			<!-- mlr change to use Number instead of ValueText-->
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER1'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER2'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER3'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER4'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER5'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER6'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER7'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER8'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER9'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFNumber">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_NUMBER10'"/>
			</xsl:call-template>

			<!-- mlr change to use DateTime instead of ValueText-->
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_DATE1'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_DATE2'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_DATE3'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_DATE4'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_DATE5'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_TIMESTAMP1'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_TIMESTAMP2'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_TIMESTAMP3'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_TIMESTAMP4'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'ATTRIBUTE_TIMESTAMP5'"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>
	<!-- GetAmount within an Extension -->

	<xsl:template name="GetAmount">
		<xsl:param name="elemName"/>
		<xsl:for-each select="oa:Amount[@typeCode = $elemName]">
			<xsl:call-template name="convertToDecimal">
				<xsl:with-param name="value" select="."/>
			</xsl:call-template>
		</xsl:for-each>
	</xsl:template>

	<!-- GetAmount within EFF Extension -->
	<xsl:template name="GetEFFAmount">
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:call-template name="GetAmount">
				<xsl:with-param name="elemName" select="$elemName"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>

	<!-- GetNamedExtAmountTime -->
	<xsl:template name="GetNamedExtAmount">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetAmount">
					<xsl:with-param name="elemName" select="$elemName"/>
				</xsl:call-template>
			</xsl:for-each>
		</xsl:element>
	</xsl:template>


	<!-- GetDateTime within an Extension -->
	<xsl:template name="GetDate">
		<xsl:param name="elemName"/>
		<xsl:for-each select="oa:DateTime[@typeCode = $elemName]">
			<xsl:value-of select="."/>
		</xsl:for-each>
	</xsl:template>

	<!-- GetValueText within EFF Extension -->
	<xsl:template name="GetEFFDate">
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:call-template name="GetDate">
				<xsl:with-param name="elemName" select="$elemName"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>


	<!-- GetDateTime within an Extension -->
	<xsl:template name="GetDateTime">
		<xsl:param name="elemName"/>
		<xsl:for-each select="oa:DateTime[@typeCode = $elemName]">
			<xsl:value-of select="."/>
		</xsl:for-each>
	</xsl:template>

	<!-- GetValueText within EFF Extension -->
	<xsl:template name="GetEFFDateTime">
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:call-template name="GetDateTime">
				<xsl:with-param name="elemName" select="$elemName"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>

	<!-- GetNamedExtDateTime -->
	<xsl:template name="GetNamedExtDateTime">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetDateTime">
					<xsl:with-param name="elemName" select="$elemName"/>
				</xsl:call-template>
			</xsl:for-each>
		</xsl:element>
	</xsl:template>

		<!-- GetNamedExtDateTime -->
	<xsl:template name="GetNamedExtWithoutElementDateTime">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>

			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetDateTime">
					<xsl:with-param name="elemName" select="$elemName"/>
				</xsl:call-template>
			</xsl:for-each>

	</xsl:template>


	<xsl:template name="GetQuantity">
		<xsl:param name="elemName"/>
		<xsl:for-each select="oa:Quantity[@typeCode = $elemName]">
			<xsl:call-template name="convertToDecimal">
				<xsl:with-param name="value" select="."/>
			</xsl:call-template>
		</xsl:for-each>
	</xsl:template>

	<!-- GetAmount within EFF Extension -->
	<xsl:template name="GetEFFQuantity">
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:call-template name="GetQuantity">
				<xsl:with-param name="elemName" select="$elemName"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>



	<!-- GetNamedExtAmountTime -->
	<xsl:template name="GetNamedExtQuantity">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetQuantity">
					<xsl:with-param name="elemName" select="$elemName"/>
				</xsl:call-template>
			</xsl:for-each>
		</xsl:element>
	</xsl:template>


	<!-- GetValueText within an Extension -->
	<xsl:template name="GetValueText">
		<xsl:param name="elemName"/>
		<xsl:for-each select="oa:ValueText[@typeCode = $elemName]">
			<xsl:value-of select="."/>
		</xsl:for-each>
	</xsl:template>

	<!-- GetNamedExtValueText -->
	<xsl:template name="GetNamedExtValueText">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>

		<xsl:element name="{$elemName}">
			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetValueText">
					<xsl:with-param name="elemName" select="$elemName"/>
				</xsl:call-template>
			</xsl:for-each>
		</xsl:element>
	</xsl:template>

	<!-- GetNamedExtValueText -->
	<xsl:template name="GetNamedExtWithoutElementValueText">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>


			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetValueText">
					<xsl:with-param name="elemName" select="$elemName"/>
				</xsl:call-template>
			</xsl:for-each>

	</xsl:template>



	<!-- GetValueText within EFF Extension -->
	<xsl:template name="GetEFFValueText">
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:call-template name="GetValueText">
				<xsl:with-param name="elemName" select="$elemName"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>


	<!-- GetNamedExtValueText -->
	<xsl:template name="GetNamedExtValueTextTypeCodeName">
		<xsl:param name="extName"/>
		<xsl:param name="elemName"/>
		<xsl:param name="typeCodeName"/>

		<xsl:element name="{$elemName}">
			<xsl:for-each select="oa:Extension[@typeCode = $extName]">
				<xsl:call-template name="GetValueText">
					<xsl:with-param name="elemName" select="$typeCodeName"/>
				</xsl:call-template>
			</xsl:for-each>
		</xsl:element>
	</xsl:template>


	<!-- GetValueText within an Extension -->
	<xsl:template name="GetNumber">
		<xsl:param name="elemName"/>
		<xsl:for-each select="oa:Number[@typeCode = $elemName]">
			<xsl:value-of select="."/>
		</xsl:for-each>
	</xsl:template>

	<!-- GetNumber within EFF Extension -->
	<xsl:template name="GetEFFNumber">
		<xsl:param name="elemName"/>
		<xsl:element name="{$elemName}">
			<xsl:call-template name="GetNumber">
				<xsl:with-param name="elemName" select="$elemName"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>

	<!-- Line -->
	<xsl:template match="oa:PurchaseOrderLine">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransOrderCustomer"/>
		<xsl:param name="createCustomer"/>

<!--		<xsl:variable name="srcTransLineID">
				<xsl:text>02-</xsl:text>
				<xsl:call-template name="getNodeCount"/>
		</xsl:variable>   -->

		<xsl:variable name="srcTransLineNumber">
			<xsl:value-of select="oa:LineNumberID"/>
		</xsl:variable>

		<xsl:variable name="srcTransLineID">
				<xsl:value-of select="$srcTransLineNumber"/>
		</xsl:variable>


		<xsl:variable name="srcTransLineCustomer">
			<xsl:value-of select="oa:LineNumberID"/>
		</xsl:variable>

		<xsl:variable name="hasSubLines">
			<xsl:choose>
				<xsl:when test="oa:PurchaseSubLine">
					<xsl:value-of select="true()"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:value-of select="false()"/>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>


		<xsl:call-template name="DoLines">
			<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
			<xsl:with-param name="srcTransOrderCustomer" select="$srcTransOrderCustomer"/>
			<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
			<xsl:with-param name="srcTransLineNumber" select="$srcTransLineNumber"/>
			<xsl:with-param name="srcTransLineCustomer" select="$srcTransLineCustomer"/>
			<xsl:with-param name="srcTransSchedID" select="$srcTransLineID"/>					<!-- For the Line IDSet/ID-->
			<xsl:with-param name="srcTransSchedNumber" select="$srcTransLineNumber"/>	<!-- For the Line set the ScheduleNumber to the Line -->
			<xsl:with-param name="hasSubLines" select="$hasSubLines"/>
			<xsl:with-param name="createCustomer" select="$createCustomer"/>
			<xsl:with-param name="isSubLine" select="false()"/>
			<xsl:with-param name="srcRootLineNumber" select="$srcTransLineNumber"/>
		</xsl:call-template>

		<xsl:apply-templates select="oa:PurchaseOrderSubLine">
			<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
			<xsl:with-param name="srcTransOrderCustomer" select="$srcTransOrderCustomer"/>
			<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
			<xsl:with-param name="srcTransLineNumber" select="$srcTransLineNumber"/>
			<xsl:with-param name="srcTransLineCustomer" select="$srcTransLineCustomer"/>
			<xsl:with-param name="createCustomer" select="$createCustomer"/>
		</xsl:apply-templates>
	</xsl:template>


	<!-- SubLine -->
	<xsl:template match="oa:PurchaseOrderSubLine">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransOrderCustomer"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransLineNumber"/>
		<xsl:param name="srcTransLineCustomer"/>
		<xsl:param name="createCustomer"/>


		<!-- SubLine LinNumberID from the review on 8/8/2017 -->
		<xsl:variable name="srcTransSubLineNumber">
			<xsl:value-of select="oa:LineNumberID"/>
		</xsl:variable>

		<!-- concat (Line Level LineNumberId. - . SubLine Level LineNumberID) from the review on 8/8/2017 -->
		<xsl:variable name="srcTransSubLineID">
			<xsl:value-of select="concat($srcTransLineID, '-', $srcTransSubLineNumber)"/>
		</xsl:variable>



		<xsl:variable name="srcTransSubLineCustomer">
			<xsl:value-of select="oa:LineNumberID"/>
		</xsl:variable>
		<xsl:call-template name="DoLines">
			<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
			<xsl:with-param name="srcTransOrderCustomer" select="$srcTransOrderCustomer"/>
			<xsl:with-param name="srcTransLineID" select="$srcTransSubLineID"/>
			<xsl:with-param name="srcTransLineNumber" select="$srcTransSubLineNumber"/>
			<xsl:with-param name="srcTransLineCustomer" select="$srcTransLineCustomer"/>
			<xsl:with-param name="srcTransSchedID" select="$srcTransSubLineID"/>
			<xsl:with-param name="srcTransSchedNumber" select="$srcTransSubLineNumber"/>
			<xsl:with-param name="hasSubLines" select="$srcTransLineID"/>
			<xsl:with-param name="createCustomer" select="$createCustomer"/>
			<xsl:with-param name="isSubLine" select="true()"/>
			<xsl:with-param name="srcRootLineNumber" select="$srcTransLineNumber"/>
		</xsl:call-template>
	</xsl:template>

	<xsl:template name="DoLines">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransOrderCustomer"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransLineNumber"/>
		<xsl:param name="srcTransLineCustomer"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:param name="srcTransSchedNumber"/>
		<xsl:param name="hasSubLines"/>
		<xsl:param name="createCustomer"/>
		<xsl:param name="isSubLine"/>
		<xsl:param name="srcRootLineNumber"/>


		<xsl:element name="DooOrderLinesAllInt">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionLineId">
<!--				<xsl:value-of select="$localLineId"/>  -->
				<xsl:value-of select="$srcTransLineID"/>
			</xsl:element>

			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>

			</xsl:element>
			<xsl:element name="SourceTransactionScheduleNumber">
				<xsl:value-of select="$srcTransSchedNumber"/>

			</xsl:element>
			<xsl:element name="SourceTransactionLineNumber">
				<xsl:value-of select="$srcTransLineNumber"/>
			</xsl:element>
			<xsl:element name="ProductId">
				<!-- Do not map  -->
			</xsl:element>
			<xsl:element name="ProductNumber">
				<xsl:for-each select="oa:Item/oa:SupplierItemIdentification/oa:ID">

						<xsl:value-of select="."/>

				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ProductDescription">
				<xsl:for-each select="oa:Item/oa:SupplierItemIdentification">

					<xsl:call-template name="GetNamedExtWithoutElementValueText">
						<xsl:with-param name="extName" select="'OracleExtension'"/>
						<xsl:with-param name="elemName" select="'ProductDescription'"/>
					</xsl:call-template>

				</xsl:for-each>


			</xsl:element>
			<xsl:element name="SourceSysProductReference"/>
			<!-- Do not map  -->
			<xsl:element name="OrderedQuantity">
				<xsl:call-template name="convertToDecimal">
					<xsl:with-param name="value" select="oa:Quantity"/>
				</xsl:call-template>
			</xsl:element>
			<xsl:element name="OrderedUOMCode">
				<xsl:value-of select="oa:Quantity/@unitCode"/>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'OrderedUOM'"/>
			</xsl:call-template>
			<xsl:element name="RequestedFulfillmentOrganizationId"/>
			<xsl:element name="RequestedFulfillmentOrganizationCode">
				<xsl:value-of select="oa:ShipFromParty/oa:Location/oa:ID"/>

<!--				<xsl:for-each select="oa:ShipFromParty[@typeCode = 'RequestedFulfillmentOrganization']">
					<xsl:for-each select="oa:Location[@typeCode= 'RequestedFulfillmentLocation']">
						<xsl:for-each select="oa:ID[@typeCode = 'Code']">
							<xsl:value-of select="."/>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:for-each> -->

			</xsl:element>
			<xsl:element name="RequestedFulfillmentOrganizationName">
				<xsl:value-of select="oa:ShipFromParty/oa:Location/oa:Name"/>

<!--				<xsl:for-each select="oa:ShipFromParty[@typeCode = 'RequestedFulfillmentOrganization']">
					<xsl:for-each select="oa:Location[@typeCode= 'RequestedFulfillmentLocation']">
						<xsl:value-of select="oa:Name"/>
					</xsl:for-each>
				</xsl:for-each>  -->
			</xsl:element>
			<xsl:element name="BusinessUnitId">
				<!--Keys -->
				<xsl:value-of select="$configurationData1"/>
			</xsl:element>
			<xsl:element name="BusinessUnitName"/>
			<xsl:element name="RequestingBusinessUnitId">
				<xsl:value-of select="$configurationData1"/>
				<!--Keys -->
			</xsl:element>
			<xsl:element name="RequestingBusinessUnitName"/>
			<xsl:element name="SubstitutionAllowedFlag">
				<xsl:call-template name="convertBooleanToYesNo">
					<xsl:with-param name="value" select="oa:AllowSubstitutionIndicator"/>
				</xsl:call-template>
			</xsl:element>
			<xsl:element name="CustomerPONumber">
				<xsl:value-of select="$srcTransOrderCustomer"/>
			</xsl:element>
			<xsl:element name="CustomerPOLineNumber">
				<xsl:value-of select="$srcTransLineCustomer"/>
			</xsl:element>
			<xsl:element name="CustomerPOScheduleNumber"/>
			<xsl:element name="CustomerProductId">
				<!-- Don't Map -->
			</xsl:element>
			<xsl:element name="CustomerProductNumber">
				<xsl:for-each select="oa:Item/oa:ID">
<!--					<xsl:if test="@typeCode = 'Number'">  -->
							<xsl:value-of select="."/>
<!--					</xsl:if>  -->
				</xsl:for-each>

			</xsl:element>
			<xsl:element name="CustomerProductDescription">
				<xsl:for-each select="oa:Item/oa:Description">

						<xsl:value-of select="."/>

				</xsl:for-each>

			</xsl:element>
			<xsl:element name="TransactionLineTypeCode">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<!-- DVM -->
					<xsl:for-each select="oa:ValueText[@typeCode = 'TransactionLineTypeCode']">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","TRANSACTION_LINE_TYPE_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="."/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TransactionLineType'"/>
			</xsl:call-template>

			<xsl:choose>
				<xsl:when test="$isSubLine">
					<xsl:variable name="parentLineReference">
						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'ParentLineReference'"/>
						</xsl:call-template>
					</xsl:variable>

					<xsl:choose>
						<xsl:when test="$parentLineReference != ''">
							<xsl:element name="ParentLineReference">
								<xsl:value-of select="$parentLineReference"/>
							</xsl:element>
						</xsl:when>
						<xsl:otherwise>
							<xsl:element name="ParentLineReference">
								<xsl:value-of select="$srcRootLineNumber"/>
							</xsl:element>
						</xsl:otherwise>
					</xsl:choose>


					<xsl:element name="RootParentLineReference">
						<xsl:value-of select="$srcRootLineNumber"/>
					</xsl:element>

				</xsl:when>
				<xsl:otherwise>

					<!-- No configured Items no Parents  Not Mapped -->
					<xsl:element name="ParentLineReference"/>
					<xsl:element name="RootParentLineReference"/>
				</xsl:otherwise>
			</xsl:choose>

<!--			<xsl:choose>
				 hasSubLines or is a SubLine
				<xsl:when test="$hasSubLines">
					<xsl:call-template name="GetNamedExtValueText">
						<xsl:with-param name="extName" select="'OracleExtension'"/>
						<xsl:with-param name="elemName" select="'ParentLineReference'"/>
					</xsl:call-template>
					<xsl:choose>
						<xsl:when test="$srcTransSchedID != ''">
							 Is SubLine
							<xsl:element name="RootParentLineReference">
								<xsl:value-of select="$hasSubLines"/>
							</xsl:element>
						</xsl:when>
						<xsl:otherwise>
							<xsl:element name="RootParentLineReference"/>
							 Top Parent
						</xsl:otherwise>
					</xsl:choose>
				</xsl:when>
				<xsl:otherwise>
					 No configured Items no Parents  Not Mapped
					<xsl:element name="ParentLineReference"/>
					<xsl:element name="RootParentLineReference"/>
				</xsl:otherwise>
			</xsl:choose> -->
			<xsl:element name="ShippingInstructions">
				<xsl:value-of select="oa:ShippingInstructions"/>
			</xsl:element>
			<xsl:element name="PackingInstructions">
				<xsl:for-each select="oa:Note">
					<xsl:if test="@typeCode = 'PackingInstructions'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="InvoicingRuleCode">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<!-- DVM -->
					<xsl:for-each select="oa:ValueText[@typeCode = 'InvoicingRuleCode']">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","INVOICING_RULE_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="."/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'InvoicingRule'"/>
			</xsl:call-template>
			<xsl:element name="AccountingRuleCode">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<!-- DVM -->
					<xsl:for-each select="oa:ValueText[@typeCode = 'AccountingRuleCode']">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","ACCOUNTING_RULE_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="."/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'AccountingRule'"/>
			</xsl:call-template>



			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'RequestedShipDate'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'RequestedArrivalDate'"/>
			</xsl:call-template>



			<xsl:element name="ScheduleShipDate"/>
			<xsl:element name="ScheduleArrivalDate"/>
			<xsl:element name="DemandClassCode">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<!-- DVM -->
					<xsl:for-each select="oa:ValueText[@typeCode = 'DemandClassCode']">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","DEMAND_CLASS_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="."/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'DemandClass'"/>
			</xsl:call-template>
			<xsl:element name="ShippingCarrierCode">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:CarrierParty/oa:ID">
<!--						<xsl:if test="@typeCode = 'ShippingCarrierCode'"> -->
							<xsl:choose>
								<xsl:when test="$dvm">
									<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","SHIPPING_CARRIER_CODE","Trading Partner",$DvmGroup)'/>
								</xsl:when>
								<xsl:otherwise>
									<xsl:value-of select="."/>
								</xsl:otherwise>
							</xsl:choose>
<!--						</xsl:if>  -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ShippingCarrier">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:CarrierParty/oa:Name">
<!--						<xsl:if test="@typeCode = 'ShippingCarrier'"> -->
							<xsl:value-of select="."/>
<!--						</xsl:if> -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>

			<xsl:element name="PaymentTermCode">
				<xsl:for-each select="oa:PaymentTerm">
<!--					<xsl:if test="@typeCode = 'PaymentTerm'">  -->
						<xsl:for-each select="oa:ID">
<!--							<xsl:if test="@typeCode = 'TermCode'"> -->
								<xsl:choose>
									<xsl:when test="$dvm">
										<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","PAYMENT_TERM_CODE","Trading Partner",$DvmGroup)'/>
									</xsl:when>
									<xsl:otherwise>
										<xsl:value-of select="."/>
									</xsl:otherwise>
								</xsl:choose>
<!--							</xsl:if>  -->
						</xsl:for-each>
<!--					</xsl:if>  -->
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="PaymentTerm">
				<xsl:for-each select="oa:PaymentTerm">
<!--					<xsl:if test="@typeCode = 'PaymentTerm'">  -->
						<xsl:for-each select="oa:Description">
<!--							<xsl:if test="@typeCode = 'Term'">  -->
								<xsl:value-of select="."/>
<!--							</xsl:if>  -->
						</xsl:for-each>
<!--					</xsl:if>  -->
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="TransactionCategoryCode">
				<xsl:text>ORDER</xsl:text>
			</xsl:element>
			<xsl:element name="ShippingServiceLevelCode">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",oa:ShipmentServiceLevelCode,"Fusion Value",oa:ShipmentServiceLevelCode,"DVM Name","SHIPPING_SERVICE_LEVEL_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="oa:ShipmentServiceLevelCode"/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>

	<!-- mlr TransportStep\TransportationTerm Extension ShippingModeCode -->
			<xsl:element name="ShippingServiceLevel">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">

						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'ShippingServiceLevel'"/>
						</xsl:call-template>

					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>

	<!-- mlr TransportStep\TransportationTerm Extension ShippingModeCode -->
			<xsl:element name="ShippingModeCode">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">
						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'ShippingModeCode'"/>
						</xsl:call-template>

					</xsl:for-each>

<!--
					<xsl:choose>
						<xsl:when test="$dvm">
							<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",oa:TransportMethodCode,"Fusion Value",oa:TransportMethodCode,"DVM Name","SHIPPING_MODE_CODE","Trading Partner",$DvmGroup)'/>
						</xsl:when>
						<xsl:otherwise>
							<xsl:value-of select="oa:TransportMethodCode"/>
						</xsl:otherwise>
					</xsl:choose> -->
				</xsl:for-each>
			</xsl:element>
<!-- mlr  Change the typeCode to TransportationMethod Oracle Element stays ShippingMode-->
			<xsl:element name="ShippingMode">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">
						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'ShippingMode'"/>
						</xsl:call-template>

					</xsl:for-each>

				</xsl:for-each>
			</xsl:element>



			<xsl:element name="ShipmentPriorityCode"/>
			<xsl:element name="ShipmentPriority"/>
			<xsl:element name="InventoryOrganizationId"/>
			<xsl:element name="InventoryOrganizationCode"/>
			<xsl:element name="InventoryOrganizationName"/>
			<xsl:element name="FreightTermsCode">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",oa:FreightTermCode,"Fusion Value",oa:FreightTermsCode,"DVM Name","FREIGHT_TERMS_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="oa:FreightTermCode"/>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>

	<!-- mlr TransportStep\TransportationTerm Extension FreightTerms -->
			<xsl:element name="FreightTerms">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">
						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'FreightTerms'"/>
						</xsl:call-template>

<!--						<xsl:for-each select="oa:Description">
							<xsl:if test="@typeCode = 'FreightTerms'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>  -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="RequestCancelDate">
				<xsl:choose>
					<xsl:when test="$verb = 'PROCESS'">
					</xsl:when>
					<xsl:otherwise>


			<xsl:call-template name="GetNamedExtWithoutElementDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'RequestCancelDate'"/>
			</xsl:call-template>
<!--
						<xsl:for-each select="oa:Status[@typeCode='Cancel']">
							<xsl:value-of select="oa:EffectiveTimePeriod/oa:StartDateTime"/>
						</xsl:for-each>  -->
					</xsl:otherwise>
				</xsl:choose>
			</xsl:element>
			<xsl:element name="OriginalProductId"/>
			<xsl:element name="OriginalProductNumber"/>
			<xsl:element name="OriginalProductDescription"/>
			<xsl:element name="PartialShipAllowedFlag">
				<xsl:call-template name="convertBooleanToYesNo">
					<xsl:with-param name="value" select="oa:PartialShipmentAllowedIndicator"/>
				</xsl:call-template>
			</xsl:element>
			<xsl:element name="FulfillmentLineId"/>
			<xsl:element name="Comments">
				<xsl:for-each select="oa:Description">
					<xsl:if test="@typeCode = 'Comments'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="UnitListPrice"/>
			<xsl:element name="UnitSellingPrice"/>
			<xsl:element name="ExtendedAmount"/>
			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'EarliestAcceptableShipDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'LatestAcceptableShipDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'EarliestAcceptableArrivalDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'LatestAcceptableArrivalDate'"/>
			</xsl:call-template>
			<xsl:element name="PromiseShipDate"/>
			<xsl:element name="PromiseArrivalDate"/>
			<xsl:element name="SubinventoryCode"/>
			<xsl:element name="Subinventory"/>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ShipSetName'"/>
			</xsl:call-template>
			<!-- Tax is Not on the Schedule -->
			<xsl:element name="TaxExemptFlag">
				<xsl:call-template name="convertBooleanToYesNo">
					<xsl:with-param name="value" select="oa:TaxExemptIndicator"/>
				</xsl:call-template>
			</xsl:element>



			<xsl:element name="TaxClassificationCode">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<xsl:for-each select="oa:ValueText[@typeCode = 'TaxClassificationCode']">
						<xsl:if test="$dvm">
							<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","TAX_CLASSIFICATION_CODE","Trading Partner",$DvmGroup)'/>
						</xsl:if>
						<xsl:if test="not($dvm)">
							<xsl:value-of select="."/>
						</xsl:if>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:element>



			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TaxClassification'"/>
			</xsl:call-template>



			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TaxExemptionCertificateNumber'"/>
			</xsl:call-template>

			<xsl:element name="TaxExemptReasonCode">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<xsl:for-each select="oa:ValueText[@typeCode = 'TaxExemptReasonCode']">
						<xsl:if test="$dvm">
							<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","TAX_EXEMPT_REASON_CODE","Trading Partner",$DvmGroup)'/>
						</xsl:if>
						<xsl:if test="not($dvm)">
							<xsl:value-of select="."/>
						</xsl:if>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:element>


			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TaxExemptReason'"/>
			</xsl:call-template>

			<xsl:element name="DefaultTaxationCountry">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<xsl:for-each select="oa:ValueText[@typeCode = 'DefaultTaxationCountry']">
						<xsl:if test="$dvm">
							<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","COUNTRY_CODE","Trading Partner",$DvmGroup)'/>
						</xsl:if>
						<xsl:if test="not($dvm)">
							<xsl:value-of select="."/>
						</xsl:if>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:element>


			<xsl:element name="DefaultTaxCountryShortName">
				<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
					<xsl:for-each select="oa:ValueText[@typeCode = 'DefaultTaxCountryShortName']">
						<xsl:if test="$dvm">
							<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","COUNTRY_SHORT_NAME","Trading Partner",$DvmGroup)'/>
						</xsl:if>
						<xsl:if test="not($dvm)">
							<xsl:value-of select="."/>
						</xsl:if>
				</xsl:for-each>
			</xsl:for-each>
		</xsl:element>



							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'FirstPartyTaxRegistration'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'FirstPartyTaxRegistrationNumber'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'ThirdPartyTaxRegistration'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'ThirdPartyTaxRegistrationNumber'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'DocumentSubtype'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'DocumentSubtypeName'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'ProductFiscalCategoryId'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'ProductFiscalCategoryName'"/>
							</xsl:call-template>


			<xsl:element name="ProductType">
				<xsl:for-each select="oa:Item">
					<xsl:for-each select="oa:Classification">

<!--						<xsl:if test="@typeCode = 'ProductType'">  -->
							<xsl:for-each select="oa:Codes">
								<xsl:for-each select="oa:Code">
									<xsl:if test="@typeCode = 'ProductType'">
										<xsl:choose>
											<xsl:when test="$dvm">
												<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","PRODUCT_TYPE","Trading Partner",$DvmGroup)'/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:value-of select="."/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:if>
								</xsl:for-each>
							</xsl:for-each>
<!--						</xsl:if>  -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
<!-- mlr  move name to the CLassificationExtension-->
			<xsl:element name="ProductTypeName">
				<xsl:for-each select="oa:Item">
					<xsl:for-each select="oa:Classification">
						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'ProductTypeName'"/>
						</xsl:call-template>

<!--						<xsl:if test="@typeCode = 'ProductType'">
							<xsl:for-each select="oa:Codes">
								<xsl:for-each select="oa:Code">
									<xsl:if test="@typeCode = 'ProductTypeName'">
										<xsl:value-of select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:if>  -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ProductCategory">
				<xsl:for-each select="oa:Item">
					<xsl:for-each select="oa:Classification">
<!--						<xsl:if test="@typeCode = 'ProductCategory'"> -->
							<xsl:for-each select="oa:Codes">
								<xsl:for-each select="oa:Code">
									<xsl:if test="@typeCode = 'ProductCategory'">
										<xsl:choose>
											<xsl:when test="$dvm">
												<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","PRODUCT_CATEGORY","Trading Partner",$DvmGroup)'/>
												<xsl:value-of select="."/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:value-of select="."/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:if>
								</xsl:for-each>
							</xsl:for-each>
<!--						</xsl:if> -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>

<!-- mlr  move name to the CLassificationExtension-->
			<xsl:element name="ProductCategoryName">
				<xsl:for-each select="oa:Item">
					<xsl:for-each select="oa:Classification">
						<xsl:call-template name="GetNamedExtWithoutElementValueText">
							<xsl:with-param name="extName" select="'OracleExtension'"/>
							<xsl:with-param name="elemName" select="'ProductCategoryName'"/>
						</xsl:call-template>

<!--						<xsl:if test="@typeCode = 'ProductCategory'">
							<xsl:for-each select="oa:Codes">
								<xsl:for-each select="oa:Code">
									<xsl:if test="@typeCode = 'ProductCategoryName'">
										<xsl:value-of select="."/>
									</xsl:if>
								</xsl:for-each>
							</xsl:for-each>
						</xsl:if>  -->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
<!--			<xsl:choose>
				<xsl:when test="oa:Tax[@typeCode = 'Tax']">
					<xsl:for-each select="oa:Tax">
						<xsl:if test="@typeCode = 'Tax'">  -->
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'TransactionBusinessCategory'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'TransactionBusinessCategoryName'"/>
							</xsl:call-template>
							<xsl:element name="AssessableValue"/>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'UserDefinedFiscalClass'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'UserDefinedFiscalClassName'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'IntendedUseClassificationId'"/>
							</xsl:call-template>
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'IntendedUseClassificationName'"/>
							</xsl:call-template>
<!--						</xsl:if>
					</xsl:for-each>
				</xsl:when>
				<xsl:otherwise>
					<xsl:element name="TransactionBusinessCategory"/>
					<xsl:element name="TransactionBusinessCategoryName"/>
					<xsl:element name="AssessableValue"/>
					<xsl:element name="UserDefinedFiscalClass"/>
					<xsl:element name="UserDefinedFiscalClassName"/>
					<xsl:element name="IntendedUseClassificationId"/>
					<xsl:element name="IntendedUseClassificationName"/>
				</xsl:otherwise>
			</xsl:choose>  -->

<!-- mlr Extension TransportStep/TransportationTerm  -->
			<xsl:element name="FOBPointCode">
				<xsl:for-each select="oa:TransportStep">
					<xsl:for-each select="oa:TransportationTerm">
						<xsl:for-each select="oa:Extension[@typeCode = 'OracleExtension']">
							<xsl:for-each select="oa:ValueText[@typeCode = 'FOBPointCode']">
								<xsl:if test="$dvm">
									<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","COUNTRY_SHORT_NAME","Trading Partner",$DvmGroup)'/>
								</xsl:if>
								<xsl:if test="not($dvm)">
									<xsl:value-of select="."/>
								</xsl:if>
							</xsl:for-each>
						</xsl:for-each>

<!--						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",oa:IncotermsCode,"Fusion Value",oa:IncotermsCode,"DVM Name","FOB_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="oa:IncotermsCode"/>
							</xsl:otherwise>
						</xsl:choose>
-->
					</xsl:for-each>
				</xsl:for-each>
			</xsl:element>
			<xsl:choose>
				<xsl:when test="oa:TransportStep/oa:TransportationTerm">
					<xsl:for-each select="oa:TransportStep">
						<xsl:for-each select="oa:TransportationTerm">
							<xsl:call-template name="GetNamedExtValueText">
								<xsl:with-param name="extName" select="'OracleExtension'"/>
								<xsl:with-param name="elemName" select="'FobPoint'"/>
							</xsl:call-template>
						</xsl:for-each>
					</xsl:for-each>
				</xsl:when>
				<xsl:otherwise>
					<xsl:element name="FobPoint"/>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:element name="OrigSysDocumentReference">
				<xsl:value-of select="$bodid"/>
			</xsl:element>
			<xsl:element name="OrigSysDocumentLineReference"/>
			<xsl:choose>
				<xsl:when test="$verb = 'PROCESS'">
					<xsl:element name="CancelReasonCode"/>
					<xsl:element name="CancelReason"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:element name="CancelReasonCode">
						<xsl:for-each select="oa:Status">
<!--							<xsl:if test="@typeCode ='Cancel'">  -->
								<xsl:value-of select="oa:ReasonCode"/>
<!--							</xsl:if> -->
						</xsl:for-each>
					</xsl:element>
					<xsl:element name="CancelReason">
						<xsl:for-each select="oa:Status">
<!--							<xsl:if test="@typeCode ='Cancel'">  -->
								<xsl:value-of select="oa:Reason"/>
<!--							</xsl:if>  -->
						</xsl:for-each>
					</xsl:element>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:element name="SubstitutionReasonCode"/>
			<xsl:element name="SubstitutionReason"/>
			<xsl:element name="ReturnReasonCode"/>
			<xsl:element name="ReturnReason"/>
			<xsl:element name="QuantityPerModel"/>
			<xsl:element name="UnitQuantity"/>
			<xsl:element name="SortLineNumber"/>

			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ContractStartDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ContractEndDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtQuantity">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TotalContractQuantity'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtAmount">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TotalContractAmount'"/>
			</xsl:call-template>
<!--
			<xsl:element name="ContractStartDate"/>
			<xsl:element name="ContractEndDate"/>
			<xsl:element name="TotalContractQuantity"/>
			<xsl:element name="TotalContractAmount"/> -->

			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'RequiredFulfillmentDate'"/>
			</xsl:call-template>
			<!-- to here -->
			<xsl:element name="ComponentIdPath"/>
			<xsl:element name="IsValidConfiguration"/>
			<xsl:element name="ConfiguratorPath"/>
			<xsl:element name="ConfigHeaderId"/>
			<xsl:element name="ConfigRevisionNumber"/>
			<xsl:choose>
				<xsl:when test="$verb = 'PROCESS'">
					<xsl:element name="OperationMode"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:element name="OperationMode">
						<xsl:if test="@actionCode = 'Delete'">
							<xsl:text>CANCEL</xsl:text>
						</xsl:if>
					</xsl:element>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:element name="ConfigInventoryItemIdentifier"/>
			<xsl:element name="ConfigItemReference"/>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ServiceDuration'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ServiceDurationCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ServiceDurationUOM'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SalesPersonId'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SalesPerson'"/>
			</xsl:call-template>

            <xsl:call-template name="GetNamedExtValueText">
                <xsl:with-param name="extName" select="'OracleExtension'" />
                <xsl:with-param name="elemName" select="'AssetGroupNumber'"/>
            </xsl:call-template>

            <xsl:call-template name="GetNamedExtDateTime">
                <xsl:with-param name="extName" select="'OracleExtension'" />
                <xsl:with-param name="elemName" select="'ServiceCancelDate'"/>
            </xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'AgreementHeaderId'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'AgreementNumber'"/>
			</xsl:call-template>



			<xsl:call-template name="DoAddresses">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
				<xsl:with-param name="createCustomer" select="$createCustomer"/>
			</xsl:call-template>

			<xsl:apply-templates select="oa:Extension[@typeCode = 'OraclePaymentExtension']">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
			</xsl:apply-templates>
			<!-- LotSerials
			<xsl:apply-templates select="oa:Item/oa:Lot">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
			</xsl:apply-templates>  -->

			<xsl:apply-templates select="oa:DocumentReference">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
			</xsl:apply-templates>
			<!--
			<xsl:apply-templates select="oa:DistributeCharge">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
			</xsl:apply-templates>   -->

			<!-- DDOO_ORDER_BILLING_PLANS_INT  -->
			<xsl:apply-templates select="oa:Extension[@typeCode = 'OracleBillingPlanExtension']">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
				<xsl:with-param name="extName" select="'DooOrderBillingPlansInt'"/>
			</xsl:apply-templates>

			<!-- DOO_ORDER_LINES_ALL_EFF_B_INT  -->
			<xsl:apply-templates select="oa:Extension[@typeCode = 'OracleEFFExtension']">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
				<xsl:with-param name="extName" select="'DooOrderLinesAllEffBInt'"/>
			</xsl:apply-templates>


			<xsl:apply-templates select="oa:Item/oa:Specification">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
			</xsl:apply-templates>
		</xsl:element>
	</xsl:template>


	<!-- Line DOO_ORDER_BILLING_PLANS_INT -->
	<xsl:template match="oa:Extension[@typeCode = 'OracleBillingPlanExtension']">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:param name="extName"/>

		<xsl:element name="{$extName}">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>


					<xsl:element name="SourceTransactionLineId">
						<xsl:if test="$srcTransLineID">
							<xsl:value-of select="$srcTransLineID"/>
						</xsl:if>
					</xsl:element>
					<xsl:element name="SourceTransactionScheduleId">
						<xsl:value-of select="$srcTransSchedID"/>

					</xsl:element>

			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'BillingPlanTypeCode'"/>
			</xsl:call-template>

			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'PeriodicityCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'NumberofBillingPeriods'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'BillingPeriodStartDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'BillingPeriodEndDate'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'BillingTransactionDate'"/>
			</xsl:call-template>

			<!-- mlr BillingPeriodNumber and OverridePeriod are integer types chech for integer -->
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'BillingPeriodNumber'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'OverridePeriod'"/>
			</xsl:call-template>


			<xsl:call-template name="GetEFFQuantity">
				<xsl:with-param name="elemName" select="'OverridePeriodQuantity'"/>
			</xsl:call-template>
			<xsl:call-template name="GetEFFAmount">
				<xsl:with-param name="elemName" select="'OverridePeriodAmount'"/>
			</xsl:call-template>

			<xsl:call-template name="GetEFFDateTime">
				<xsl:with-param name="elemName" select="'CancellationEffectiveDate'"/>
			</xsl:call-template>

<!--			<xsl:call-template name="GetEFFValueText">
				<xsl:with-param name="elemName" select="'SourceBillingPlanId'"/>
			</xsl:call-template>  -->

			<xsl:element name="SourceBillingPlanId">
				<xsl:text>11-</xsl:text>
				<xsl:call-template name="getNodeCount"/>
			</xsl:element>

		</xsl:element>
	</xsl:template>



	<xsl:template match="oa:Specification">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>

		<xsl:element name="DooOrderTxnAttributesInt">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>
			</xsl:element>

			<!-- mlr Auto generated concat MessageID-04-sequentialNumber (5chars) -->
			<xsl:element name="SourceTransactionLineAttributeId">
				<xsl:text>04-</xsl:text>
				<xsl:call-template name="getNodeCount"/>

			</xsl:element>
			<xsl:element name="TransactionAttributeCode">
				<xsl:for-each select="oa:ID">
<!--					<xsl:if test="@typeCode = 'AttributeCode'">  -->
						<xsl:choose>
							<xsl:when test="$dvm">
								<xsl:value-of select='dvm:lookupValue("oramds:/apps/oracle/apps/prc/po/dvm/FusionCode.dvm","Trading Partner Value",.,"Fusion Value",.,"DVM Name","TRANSACTION_ATTRIBUTE_CODE","Trading Partner",$DvmGroup)'/>
							</xsl:when>
							<xsl:otherwise>
								<xsl:value-of select="."/>
							</xsl:otherwise>
						</xsl:choose>
<!--					</xsl:if> -->
				</xsl:for-each>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TransactionAttributeName'"/>
			</xsl:call-template>
			<xsl:element name="TransactionAttributeId"/>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'CharacterValue'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'NumberValue'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'DateValue'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtDateTime">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TimestampValue'"/>
			</xsl:call-template>


<!--			<xsl:element name="CharacterValue">
				<xsl:for-each select="oa:Property">
					<xsl:if test="oa:NameValue[@typeCode = 'CharacterValue']">
						<xsl:value-of select="oa:NameValue"/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="NumberValue">
				<xsl:for-each select="oa:Property">
					<xsl:if test="oa:NameValue[@typeCode = 'NumberValue']">
						<xsl:value-of select="oa:NameValue"/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="DateValue">
				<xsl:for-each select="oa:Property">
					<xsl:if test="oa:NameValue[@typeCode = 'DateValue']">
						<xsl:value-of select="oa:NameValue"/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="TimestampValue">
				<xsl:for-each select="oa:Property">
					<xsl:if test="oa:NameValue[@typeCode = 'TimestampValue']">
						<xsl:value-of select="oa:NameValue"/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>  -->
		</xsl:element>
	</xsl:template>

	<xsl:template match="oa:Lot">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>

		<xsl:element name="DooOrderLotSerialsInt">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>
			</xsl:element>

			<xsl:element name="SourceTransactionLotId">
				<xsl:text>07-</xsl:text>
				<xsl:call-template name="getNodeCount"/>

			</xsl:element>
			<xsl:element name="LotNumber">
				<xsl:for-each select="oa:ID">
<!--					<xsl:if test="@typeCode = 'Number'">  -->
						<xsl:value-of select="."/>
<!--					</xsl:if>  -->
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="SerialNumberFrom">
				<xsl:for-each select="oa:ID">
					<xsl:if test="@schemeID = 'SerialNumberFrom'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="SerialNumberTo">
				<xsl:for-each select="oa:ID">
					<xsl:if test="@schemeID = 'SerialNumberTo'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="ItemRevisionNumber">
				<xsl:for-each select="oa:ID">
					<xsl:if test="@typeCode = 'ItemRevisionNumber'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
			<xsl:element name="LocatorId">
				<xsl:for-each select="oa:IDSet">
					<xsl:if test="@typeCode = 'ID'">
						<xsl:for-each select="oa:ID">
							<xsl:if test="@typeCode = 'ID'">
								<xsl:value-of select="."/>
							</xsl:if>
						</xsl:for-each>
					</xsl:if>
				</xsl:for-each>
			</xsl:element>
		</xsl:element>
	</xsl:template>

	<xsl:template match="oa:DistributeCharge">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:element name="DooOrderChargeInt">

			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>
			</xsl:element>

			<xsl:variable name="chargeID">
				<xsl:text>09-</xsl:text>
				<xsl:call-template name="getNodeCount"/>

			</xsl:variable>
			<xsl:variable name="chargeNumber">
				<xsl:for-each select="oa:ID">
					<xsl:if test="@typeCode = 'Number'">
						<xsl:value-of select="."/>
					</xsl:if>
				</xsl:for-each>
			</xsl:variable>
			<xsl:element name="SourceChargeId">
				<xsl:value-of select="$chargeID"/>
			</xsl:element>
			<xsl:for-each select="oa:Description">
				<xsl:element name="ChargeDefinitionCode">
					<xsl:value-of select="@typeCode"/>
				</xsl:element>
				<xsl:element name="ChargeDefinitionCode">
					<xsl:value-of select="."/>
				</xsl:element>
			</xsl:for-each>
			<xsl:element name="ChargeTypeCode">
				<xsl:value-of select="@typeCode"/>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeType'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeSubtype'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeSubtypeCode'"/>
			</xsl:call-template>
			<xsl:element name="SequenceNumber">
				<xsl:value-of select="@sequenceNumber"/>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PriceTypeCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PriceType'"/>
			</xsl:call-template>
			<xsl:element name="PricedQuantity">
				<xsl:call-template name="convertToDecimal">
					<xsl:with-param name="value" select="oa:BasisQuantity"/>
				</xsl:call-template>
			</xsl:element>
			<xsl:element name="PricedQuantityUOMCode">
				<xsl:value-of select="oa:BasisQuantity/@unitCode"/>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PricedQuantityUOM'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PrimaryFlag'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ApplyTo'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'RollupFlag'"/>
			</xsl:call-template>
			<xsl:element name="ChargeCurrencyCode">
				<xsl:value-of select="oa:Amount/@currencyCode"/>
			</xsl:element>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeCurrencyName'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PricePeriodicityCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'GSAUnitPrice'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TransactionalCurrencyCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TransactionalUOMCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'AverageUnitSellingPrice'"/>
			</xsl:call-template>
			<xsl:apply-templates select="oa:Distribution">
				<xsl:with-param name="srcTransOrderID" select="$srcTransOrderID"/>
				<xsl:with-param name="srcTransLineID" select="$srcTransLineID"/>
				<xsl:with-param name="srcTransSchedID" select="$srcTransSchedID"/>
				<xsl:with-param name="srcTransChargeID" select="$chargeID"/>
			</xsl:apply-templates>
		</xsl:element>
	</xsl:template>

	<xsl:template match="oa:Distribution">
		<xsl:param name="srcTransOrderID"/>
		<xsl:param name="srcTransLineID"/>
		<xsl:param name="srcTransSchedID"/>
		<xsl:param name="srcTransChargeID"/>

		<xsl:element name="DooOrderChargeCompsInt">
			<xsl:element name="SourceTransactionId">
				<xsl:value-of select="$srcTransOrderID"/>
			</xsl:element>
			<xsl:element name="SourceTransactionSystem">
				<xsl:value-of select="$eoss"/>
			</xsl:element>
			<xsl:element name="SourceTransactionLineId">
				<xsl:if test="$srcTransLineID">
					<xsl:value-of select="$srcTransLineID"/>
				</xsl:if>
			</xsl:element>
			<xsl:element name="SourceTransactionScheduleId">
				<xsl:value-of select="$srcTransSchedID"/>
			</xsl:element>
			<xsl:element name="SourceChargeComponentId">
				<xsl:text>10-</xsl:text>
				<xsl:call-template name="getNodeCount"/>

			</xsl:element>
			<xsl:element name="SourceChargeId">
				<xsl:value-of select="$srcTransChargeID"/>
			</xsl:element>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SequenceNumber'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'SourceParentChargeCompId'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeCurrencyCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeCurrencyName'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeCurrencyExtendedAmount'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'ChargeCurrencyUnitPrice'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'HeaderCurrencyCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'HeaderCurrencyName'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'HeaderCurrencyExtendedAmount'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'HeaderCurrencyUnitPrice'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PriceElementCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PriceElement'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PriceElementUsageCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'PriceElementUsage'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'RollupFlag'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'TransactionalCurrencyCode'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'Explanation'"/>
			</xsl:call-template>

			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'DurationChargeTotal'"/>
			</xsl:call-template>
			<xsl:call-template name="GetNamedExtValueText">
				<xsl:with-param name="extName" select="'OracleExtension'"/>
				<xsl:with-param name="elemName" select="'DurationHeaderTotal'"/>
			</xsl:call-template>
		</xsl:element>
	</xsl:template>


	<xsl:template name="convertBooleanToYesNo">
		<xsl:param name="value"/>

		<xsl:call-template name="convertFlagToIndicator">
			<xsl:with-param name="value" select="$value"/>
		</xsl:call-template>
	</xsl:template>


    <xsl:template name="convertToDecimal">
		<xsl:param name="value"/>

		<xsl:choose>
			<xsl:when test="$xpath">
				<xsl:value-of select="$value"/>
			</xsl:when>
			<xsl:otherwise>

		<xsl:choose>
			<xsl:when test="contains($value, ',')">
				<xsl:choose>
					<xsl:when test="number(translate($value, ',', ''))">

						<xsl:value-of select="translate($value, ',', '')"/>
					</xsl:when>
					<xsl:otherwise>

					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$value"/>
			</xsl:otherwise>
		</xsl:choose>

			</xsl:otherwise>
		</xsl:choose>


	</xsl:template>

	 <xsl:template name="convertToInteger">
		<xsl:param name="value"/>

		<xsl:choose>
			<xsl:when test="$xpath">
				<xsl:value-of select="$value"/>
			</xsl:when>
			<xsl:otherwise>


		<xsl:choose>
			<xsl:when test="contains($value, ',')">
				<xsl:choose>
					<xsl:when test="number(translate($value, ',', ''))">

						<xsl:value-of select="translate($value, ',', '')"/>
					</xsl:when>
					<xsl:otherwise>

					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$value"/>
			</xsl:otherwise>
		</xsl:choose>


			</xsl:otherwise>
		</xsl:choose>

	</xsl:template>



	<xsl:template name="convertFlagToIndicator">
		<xsl:param name="value"/>

		<xsl:choose>
			<xsl:when test="$xpath">
				<xsl:value-of select="$value"/>
			</xsl:when>
			<xsl:otherwise>

		<xsl:choose>
			<xsl:when test="$value = 'true'"><xsl:text>Y</xsl:text></xsl:when>
			<xsl:when test="$value = '1'"><xsl:text>Y</xsl:text></xsl:when>
			<xsl:when test="$value = 'false'"><xsl:text>N</xsl:text></xsl:when>
			<xsl:when test="$value = '0'"><xsl:text>N</xsl:text></xsl:when>
		</xsl:choose>

			</xsl:otherwise>
		</xsl:choose>



	</xsl:template>

	<xsl:template name="getNodeCount">
		<xsl:value-of select="count(preceding::*) + 1"/>
	</xsl:template>



	<xsl:template name="convertToDate">
		<xsl:param name="value"/>

		<xsl:choose>
			<xsl:when test="$xpath">
				<xsl:value-of select="$value"/>
			</xsl:when>
			<xsl:otherwise>

				<xsl:choose>
					<xsl:when test="string-length($value) = 10 and contains($value, '-')">
						<xsl:value-of select="$value"/>
					</xsl:when>
				</xsl:choose>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="convertToDateTime">
		<xsl:param name="value"/>

		<xsl:choose>
			<xsl:when test="$xpath">
				<xsl:value-of select="$value"/>
			</xsl:when>
			<xsl:otherwise>

				<xsl:choose>
					<xsl:when test="contains($value,'T') and contains($value, '-') and contains($value,':')">
						<xsl:value-of select="$value"/>
					</xsl:when>
				</xsl:choose>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
</xsl:stylesheet>